{% extends "base.html" %}
{% block content %}
<h3>Create Survey Form</h3>

<form method="POST" class="mt-3">
    {% csrf_token %}
    <div class="form-group">
        <label>Form Title</label>
        <input type="text" name="title" class="form-control" placeholder="Enter form title">
    </div>

    <div id="question-list">
        <div class="card mb-3 p-3 question-item">
            <div class="form-group">
                <label>Question</label>
                <input type="text" name="questions[]" class="form-control" placeholder="Enter question">
            </div>
            <div class="form-group">
                <label>Answer Type</label>
                <select name="answer_type[]" class="form-control">
                    <option value="text">Text</option>
                    <option value="choice">Multiple Choice</option>
                </select>
            </div>
            <div class="form-group choice-options d-none">
                <label>Options (comma-separated)</label>
                <input type="text" name="options[]" class="form-control" placeholder="Option1,Option2">
            </div>
        </div>
    </div>

    <button type="button" class="btn btn-info mb-3" id="add-question">+ Add Question</button>
    <button type="submit" class="btn btn-success">Save Form</button>
</form>

<script>
document.getElementById('add-question').addEventListener('click', function() {
    let clone = document.querySelector('.question-item').cloneNode(true);
    clone.querySelectorAll('input').forEach(i => i.value='');
    clone.querySelector('.choice-options').classList.add('d-none');
    document.getElementById('question-list').appendChild(clone);
});

document.addEventListener('change', function(e){
    if(e.target.name === "answer_type[]"){
        let card = e.target.closest('.question-item');
        let opt = card.querySelector('.choice-options');
        opt.classList.toggle('d-none', e.target.value !== 'choice');
    }
});
</script>
{% endblock %}
